<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

 <script type="text/javascript">
    function handleDrop(event, ui) {
        var droppedProduct = ui.draggable;
 
        droppedProduct.fadeOut('fast');
    }
</script>

<h:head><title>Welcome</title></h:head>
<body>
	<f:view> 
		<ui:include src="/pages/unsecure/menu.xhtml" />
		<br/>
		<br/>
		<h:form id="productForm">
		    <p:fieldset id="availableProductsField" legend="Available Products">
		        <p:dataTable id="availableProducts" var="product" value="#{dndProductsView.products}">
		            <p:column style="width:20px">
		                <h:outputText id="dragIcon" styleClass="ui-icon ui-icon-arrow-4" />
		                <p:draggable for="dragIcon" revert="true" helper="clone"/>
		            </p:column>
		 
		            <p:column headerText="Id">
		                <h:outputText value="#{product.id}" />
		            </p:column>
		 
		            <p:column headerText="Name">
		                <h:outputText value="#{product.name}" />
		            </p:column>
		 
		            <p:column headerText="Description">
		                <h:outputText value="#{product.description}" />
		            </p:column>
		 
		            <p:column headerText="Price">
		                <h:outputText value="#{product.price}" />
		            </p:column>
		            
		            <p:column headerText="Image">
			            <p:graphicImage value="#{dndProductView.image}" width="50"  id="grpImage" height="80">
				            <f:param name="studentId" value="#{product.id}" />
				        </p:graphicImage>
		            </p:column>
		            
		        </p:dataTable>
		    </p:fieldset>
		 
		    <p:fieldset id="selectedProducts" legend="Selected Products" style="margin-top:20px">
		        <p:outputPanel id="dropArea">
		            <h:outputText value="!!!Drop here!!!" rendered="#{empty dndProductsView.droppedProducts}" style="font-size:24px;" />
		            <p:dataTable id="selectedProductsTable" var="product" value="#{dndProductsView.droppedProducts}" rendered="#{not empty dndProductsView.droppedProducts}">
		                <p:column headerText="Id">
		                    <h:outputText value="#{product.id}" />
		                </p:column>
		 
		                <p:column headerText="Name">
		                    <h:outputText value="#{product.name}" />
		                </p:column>
		 
		                <p:column headerText="Description">
		                    <h:outputText value="#{product.description}" />
		                </p:column>
		 
		                <p:column headerText="Price">
		                    <h:outputText value="#{product.price}" />
		                </p:column>
		                
		                <p:column headerText="Image">
		                 <p:graphicImage value="#{dndProductView.image}" width="50"  id="grpImage" height="80">
				            <f:param name="studentId" value="#{product.id}" />
				         </p:graphicImage>	
		                </p:column>
		                
		                <p:column style="width:32px">
		                    <p:commandButton update=":productForm:display" oncomplete="PF('productDialog').show()" icon="ui-icon-search">
		                        <f:setPropertyActionListener value="#{product}" target="#{dndProductsView.selectedProduct}" />
		                    </p:commandButton>
		                </p:column>
		            </p:dataTable>
		        </p:outputPanel>
		    </p:fieldset>
		 
		    <p:droppable for="selectedProducts" tolerance="touch" activeStyleClass="ui-state-highlight" datasource="availableProducts" onDrop="handleDrop">
		        <p:ajax listener="#{dndProductsView.onProductDrop}" update="dropArea availableProducts" />
		    </p:droppable>
		 
		    <p:dialog header="Product Detail" widgetVar="productDialog" resizable="false" draggable="false"
		                showEffect="fade" hideEffect="fade" modal="true">
		 
		        <p:outputPanel id="display">
		            <h:panelGrid columns="2" cellpadding="4" rendered="#{not empty dndProductsView.selectedProduct}">
		                <f:facet name="header">
		                    <p:graphicImage value="#{product.foto}"/>
		                </f:facet>
		 
		                <h:outputText value="Id:" />
		                <h:outputText value="#{dndProductsView.selectedProduct.id}" style="font-weight:bold"/>
		 
		                <h:outputText value="Name:" />
		                <h:outputText value="#{dndProductsView.selectedProduct.name}" style="font-weight:bold"/>
		 
		                <h:outputText value="Description:" />
		                <h:outputText value="#{dndProductsView.selectedProduct.description}" style="font-weight:bold"/>
		 
		                <h:outputText value="Price:" />
		                <h:outputText value="#{dndProductsView.selectedProduct.price}" style="font-weight:bold"/>
		            </h:panelGrid>
		        </p:outputPanel>
		    </p:dialog>
		</h:form>
</f:view>
</body>
</html>